(function(a){a.validator.passwordStrengthLevel=function(b){var d=0;if(b.length<4){return d}d+=b.length*4;var c=function(e,l){var h="";for(var g=0;g<l.length;g++){var k=true;for(var f=0;f<e&&(f+g+e)<l.length;f++){k=k&&(l.charAt(f+g)==l.charAt(f+g+e))}if(f<e){k=false}if(k){g+=e-1;k=false}else{h+=l.charAt(g)}}return h};d+=(c(1,b).length-b.length)*1;d+=(c(2,b).length-b.length)*1;d+=(c(3,b).length-b.length)*1;d+=(c(4,b).length-b.length)*1;if(b.match(/(.*[0-9].*[0-9].*[0-9])/)){d+=5}if(b.match(/(.*[!,@,#,$,%,^,&,*,?,_,~].*[!,@,#,$,%,^,&,*,?,_,~])/)){d+=5}if(b.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)){d+=10}if(b.match(/([a-zA-Z])/)&&b.match(/([0-9])/)){d+=15}if(b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([0-9])/)){d+=15}if(b.match(/([!,@,#,$,%,^,&,*,?,_,~])/)&&b.match(/([a-zA-Z])/)){d+=15}if(b.match(/^\w+$/)||b.match(/^\d+$/)){d-=10}if(d<0){d=0}if(d>100){d=100}return d};jQuery.validator.addMethod("normalPassword",function(g,d,h){if(!a.validator.methods.required.call(this,g,d)){return false}var c=6,b=20;var f="^[\\w\\-~!@#$%^&*()+{}[\\]:]{_min_,_max_}$";if(h.length){c=h[0];b=h[1]}f=f.replace("_min_",c).replace("_max_",b);var e=new RegExp(f);return this.optional(d)||e.test(g)},"Please enter a valid password between 6 and 20 words.");jQuery.validator.addMethod("strengthPassword",function(j,g,e){var f=6,h=20;var m="^[\\w\\-~!@#$%^&*()+{}[\\]:]{_min_,_max_}$";if(e.length){settings=a.extend(settings,e)}var l=a.validator.methods.normalPassword.call(this,j,g,e);var d=this.idOrName(g);var c=d+"-info";var i=a(g).siblings("#"+c+":first");if(!i.length){i=a("<span />").attr("id",c);i.insertAfter(g)}if(l){var b=a.validator.passwordStrengthLevel(j);var k="pwdis"+parseInt(b/10+1)*10;i.removeClass().addClass("pwdis0 "+k).css("display","block")}else{i.hide()}return l},"Please enter a valid password between 6 and 20 words.");jQuery.validator.addMethod("remoteValid",function(h,d,i){if(this.optional(d)){return"dependency-mismatch"}var e=this.previousValue(d);if(!this.settings.messages[d.name]){this.settings.messages[d.name]={}}e.originalMessage=this.settings.messages[d.name].remoteValid;this.settings.messages[d.name].remoteValid=e.message;var g={method:"post",url:undefined,data:{}};if(typeof i=="string"){g.url={url:i}||i}else{g=a.extend(g,i)}var b=g.url;if(this.pending[d.name]){return"pending"}if(e.old===h){return e.valid}e.old=h;var c=this;this.startRequest(d);var f=g.data;f[d.name]=h;a.ajax(a.extend(true,{url:b,type:g.method,mode:"abort",port:"validate"+d.name,dataType:"json",data:f,success:function(k){c.settings.messages[d.name].remoteValid=e.originalMessage;var m=k===true;if(m){var j=c.formSubmitted;c.prepareElement(d);c.formSubmitted=j;c.successList.push(d);c.showErrors()}else{var n={};var l=k||c.defaultMessage(d,"remoteValid");n[d.name]=e.message=a.isFunction(l)?l(h):l;c.showErrors(n)}e.valid=m;c.stopRequest(d,m)},error:function(){alert("服务端验证出错,请与系统管理员联系!")}},i));return"pending"},"Please fix this field.")})(jQuery);